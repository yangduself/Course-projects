
load('r04_edfm (2).mat')
ntr=30000;
Wopt=[-1.28477224913164;1.71186836448845;0.562178423281965;-0.127222151063187;-0.168447612173097;0.0608003672413657;0.229141337701989;0.141947425394768;-0.0986908623370537;-0.273050109978875;-0.291947313564776;-0.163520155964356;-0.0417866438373160;0.00104849719108557;-0.0401343263368332;-0.0797607598696697;-0.0806561693514603;-0.0363437373591005;0.0400087778933873;0.0547791609595203;0.0157733752567566;-0.0266403376727666;-0.0450123203850001;-0.0341753368448732;0.00178598040209543;0.00619968421230510;-0.00437466404502185;-0.0269582943218714;-0.0280082075739241;-0.00925537917945407;0.00884348517998745;0.0311226806870764;0.0385146124631772;0.0338265129861526;0.0529790723878350;0.0781870572340111;0.0924299193726910;0.0885091047825029;0.0457959140081066;-0.00472112020295690;-0.0411469968496288;-0.0626694300166122;-0.0433213821669440;-0.0383765534362794;-0.0102061515449527;-0.00488723224935317;-0.0139651223010731;0.000404774918493445;-0.00564238979565346;-0.00246964892784263;-0.00974164851371029;-0.0197478314434481;-0.0325909408753908;-0.0332924718439185;-0.0386863861902604;-0.0253170151611961;-0.0271021317518176;-0.00155164967373622;0.00998486800040865;0.0162814297189691;0.0115998978225349;-0.000978107729366684;0.00302053144220871;0.00147476244040590;0.0108013476777984;0.00814612840321161;0.0178858155283486;0.00483925421267983;0.00218288548017398;0.000341787582257780;0.00319188755045374;0.00786374948393487;0.0160097922191476;0.00956889207309075;0.00705801985627375;0.0251605856984154;0.0153848352620756;0.0135497109147735;0.000621117214105738;-0.00963616564352776;-0.0164324524955859;-0.0295919457846887;-0.0103948212296956;-0.0149270902906551;-0.00295008249628381;-0.00768049229929346;-0.0202466846893863;-0.0179655209286835;-0.0279451684998691;-0.0150520542115231;-0.0139086072689949;-0.00935301564475566;-0.00353549739030257;-0.0208285705403766;-0.0220870479614703;-0.0181194525734014;-0.00425553069442941;-0.00755656021213014;0.00955170660744642;0.00338337159784885;0.00799797273798220;-0.00432480404644764;0.00346083816412346;-0.00134277499865382;0.00488142178748774;0.00866793718385139;0.00667151057835724;0.000823556712013840;0.00158531634814807;-0.0106983751794143;-0.000351010077967118;-0.00679263683999665;-0.00135658910356540;0.00782397610460350;0.00218087322674876;0.0170278484657129;0.0110600237323339;0.0103215046191849;-0.00487811937744098;-0.0138635711793977;-0.0139602617397685;-0.0194774068500223;-0.00349392205557919;-0.00315498590489938;-0.00246417319919345;-0.00352825293789749;-0.0156158961680717;-0.0151740020504505;-0.00461839628900052;0.00640110643414538;0.0202560172233675;0.0226229587213851;0.0227523672688363;0.00751002266162004;-0.00172212413914608;-0.00296431055845403;-0.0301802100792266;-0.00884239267275788;-0.00442758375375973;0.000928491988481994;-0.00156837323490144;0.00584185016880667;-0.0118395689737696;-0.00737072716506759;-0.00654040915267728;0.00195094456660527;0.0161765652842405;0.00677053536816885;0.00392751258394952;-0.0156242023228721;-0.00734002553320456;-0.0206937261016584;-0.00974820340016791;-0.0100330956165422;0.0121595369606382;0.00241087683181185;0.000800899296088176;-0.0105464001911102;0.00200427224776512;-0.000469516219871124;0.00729559003509905;0.00885700440872483;0.00297775382987098;-0.00173109065958865;-0.00524547792909524;-0.00537510353402126;0.0134882679243424;0.0155016188025456;0.0192722483447838;-0.00274913419437794;-0.00682717272713163;-0.0113282903425684;-0.0127526302239716;-0.000454563357713766;0.00573008162209021;0.0137604583453737;-0.0147911118350983;-0.0112338129498681;-0.0149316781360263;-0.00539854790955729;0.00292515736401811;0.0136224382461485;0.00473793066236139;0.00325145676360705;-0.00597794139870977;-0.00690429788607538;0.000527032469491928;-0.00268655597464473;0.0124706354478157;-0.0153077812940978;-0.0140166971844629;-0.00522468434036139;-0.0152315462628216;0.00278333426990685;0.00598909594735853;0.00276639846114080;0.00187949392108422;0.000924098639101700;-0.00466205458968716;0.00451055701207537;-0.00204564013299802;0.00496389292048605;0.00439553735276377;0.0162397831728640;0.0106068296166368;0.0106078354293260;0.00650164636725492;0.0103554770554410;0.000550857062968646;-0.00421591480570704;0.00181130035881694;-0.00133673875272677;0.00639049667924496;0.00367443734656092;0.0205322801963916;0.0142069897634229;0.00566279236596756;-0.00263560757882431;-0.000460746316008454;0.000608088901401516;0.0160873752496116;0.0229106725739250;0.00994242565370485;0.000585658675390732;-0.00253081942832623;-0.00156457528822784;0.0159367984007304;0.0256236235707945;0.0129984602795901;0.00605877327461712;-0.0180648858824632;-0.0268942413242144;0.00761137910802745;0.0139074255811469;0.0129612929853806;-0.00472703526946816;-0.0330743245062024;-0.0304565958706462;0.00347728542965342;0.0563934601612175;0.0596138100377175;0.00303183893993264;-0.0635467368422837;-0.0897241045965984;0.00826024898356081;0.144758326238048;0.166061282338887;-0.0773917018887005;-0.596837067085289;0.532231691375273];
L=250;
excessMSE = zeros(1,ntr);

muhat=0.85;
bet=0.01;
sig = 0.1;
rho = 0.9;

for k=1:1

%W = Wopt+randn(L,1);
W=zeros(L,1);
X = zeros(L,1);
dhat = zeros(1,ntr);
e = zeros(1,ntr);
x = zeros(1,ntr);
ll = 1:L-1;
llp1 = ll+1;
Wtot = zeros(L,ntr);

%d=[zeros(1,40) val(1,1:ntr-40)];
d=[val(1,1:ntr)];
%%x = x(1,101:ntr+100);
x = [val(3,1:ntr)];
for i=1:ntr
    %W=randn(L,1);
    X(llp1) = X(ll);
    X(1) = x(i);
    dhat(i) = W'*X;
    e(i) =  d(i)-dhat(i);
    W = W + (muhat/(bet+X'*X))*e(i)*X;
    Wtot(:,i) = W;
     V= W-Wopt;
    excessMSE(i) = excessMSE(i) + (V'*X)^2;    
end

end


figure(1)
semilogy(1:ntr,excessMSE/5,'-b','LineWidth',3);
figure(2)

t = (1:ntr)/1000;
plot(t,d,t,x,t,e);

legend('Desired','Input','Error')
figure(3)
plot(t,d,t,dhat,'-r')
legend('desired','estimated')